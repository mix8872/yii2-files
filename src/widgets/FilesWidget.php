<?php
/**
 * Created by PhpStorm.
 * User: Mix
 * Date: 29.10.2017
 * Time: 14:38
 */

namespace mix8872\yiiFiles\widgets;

use Yii;
use mix8872\yiiFiles\assets\FilesAsset;
use yii\base\InvalidConfigException;
use yii\base\Security;
use yii\widgets\ActiveField;
use yii\widgets\InputWidget;

class FilesWidget extends InputWidget
{
    public const THEME_BROWSE = 'browse';
    public const THEME_DRAGDROP = 'dragdrop';
    public const THEME_BROWSE_DRAGDROP = 'browse-dragdrop';

    /**
     * @var boolean enable drag-drop flag
     */
    public $theme = self::THEME_BROWSE;
    /**
     * @var string set drag-drop area width, default - '100%'
     * */
    public $width = '100%';
    /**
     * @var string set drag-drop area height, default - '100px'
     * */
    public $height = '100px';
    /**
     * @var Model the data model that this widget is associated with.
     */
    public $model;
    /**
     * @var string the model attribute that this widget is associated with (tag).
     */
    public $attribute;
    /**
     * @var array the HTML attributes for the input tag.
     */
    public $options = [];
    /**
     * @var string label of input instead of title
     * */
    public $label;
    /**
     * @var int max count of attacment files, 0 - unlimited
     * */
    public $maxCount = 0;
    /**
     * @var \mix8872\yiiFiles\behaviors\FileAttachBehavior instance of FileAttachBehavior
     */
    private $behavior;
    private $module;

    public function init()
    {
        parent::init();

        if (!$this->model) {
            throw new InvalidConfigException("'model' property must be specified.");
        }

        if (!$this->attribute) {
            throw new InvalidConfigException("'attribute' property must be specified.");
        }

        if (!($this->module = Yii::$app->getModule('files'))) {
            throw new InvalidConfigException('Module "files" is not defined');
        }

        if (!($this->behavior = $this->model->getBehavior('files'))) {
            throw new InvalidConfigException('The ' . $this->model->formName() . ' model hasn\'t "files" behavior!');
        }

        FilesAsset::register($this->view);

        if (isset($this->field)) {
            $this->field->form->options['enctype'] = 'multipart/form-data';
        } else {
            $this->label = $this->model->attributeLabels()[$this->attribute] ?? $this->attribute;
        }
    }

    public function run()
    {
        parent::run();

        $inputFileTypes = ''; //file type for input
        $jsAllowedFileTypes = []; //allowed file types for js
        $jsAllowedFileExtensions = []; //allowed file extensions for js

        $fileTypes = '*';

        preg_match('/(^|.*\])([\w\.\+]+)(\[.*|$)/u', $this->attribute, $matchedAttribute);
        $attributeName = $matchedAttribute[2];
        switch (true) {
            case isset($this->behavior->attributes[$attributeName]['filetypes']):
                $fileTypes = $this->behavior->attributes[$attributeName]['filetypes'];
                break;
            case isset($this->module->attributes[$attributeName]['filetypes']):
                $fileTypes = $this->module->attributes[$attributeName]['filetypes'];
                break;
        }
        $this->_setFiletypes($fileTypes, $inputFileTypes, $jsAllowedFileTypes, $jsAllowedFileExtensions);


        if ($langModule = \Yii::$app->getModule('languages')) {
            $languages = $langModule->languages;
        } else {
            $languages = [Yii::$app->language => Yii::$app->language];
        }

        $multiple = $this->behavior->attributes[$attributeName]['multiple'] ?? $this->module->attributes[$attributeName]['multiple'] ?? false;
        return $this->render('index', [
            'model' => $this->model,
            'attribute' => $matchedAttribute[1] . $matchedAttribute[2] . ($multiple ? '[]' : ''),
            'inputFileTypes' => $inputFileTypes,
            'jsAllowedFileTypes' => json_encode(array_values(array_unique($jsAllowedFileTypes))),
            'jsAllowedFileExtensions' => json_encode(array_values(array_unique($jsAllowedFileExtensions))),
            'multiple' => $multiple,
            'query' => $this->model->getFiles($attributeName, false, true),
            'languages' => $languages,
            'label' => $this->label,
            'uniqueName' => (new Security())->generateRandomString(10),
            'theme' => $this->theme,
            'width' => $this->width,
            'height' => $this->height,
            'maxCount' => $this->maxCount,
            'field' => $this->field ?? null
        ]);
    }

    private function _setFiletypes($types, &$fileTypes, &$allowedFileTypes, &$allowedFileExtensions)
    {
        if (is_array($types)) {
            foreach ($types as $filetype) {
                $type = explode('/', $filetype);
                $allowedFileTypes = array_merge($allowedFileTypes, self::getFType($type[0]));
                isset($type[1]) && $type[1] === '*' ?: $allowedFileExtensions[] = $this->getExtensionByMime($filetype);
                $fileTypes = implode(',', $types);
            }
        } else {
            $type = explode('/', $types);
            $allowedFileTypes = self::getFType($type[0]);
            isset($type[1]) && $type[1] === '*' ?: $allowedFileExtensions[] = $this->getExtensionByMime($types);
            $fileTypes = $types;
        }
    }

    public static function getFType($types)
    {
        switch ($types) {
            case 'application':
                $type = ['object'];
                break;
            case 'audio':
                $type = ['audio'];
                break;
            case 'image':
                $type = ['image'];
                break;
            case 'text':
                $type = ['html', 'text'];
                break;
            case 'video':
                $type = ['video'];
                break;
            default:
                $type = [];
        }
        return $type;
    }

    public static function getExtensionByMime($mime)
    {
        $types = [
            "application/vnd.lotus-1-2-3" => "123",
            "text/vnd.in3d.3dml" => "3dml",
            "video/3gpp2" => "3g2",
            "video/3gpp" => "3gp",
            "application/x-7z-compressed" => "7z",
            "application/x-authorware-bin" => "aab",
            "audio/x-aac" => "aac",
            "application/x-authorware-map" => "aam",
            "application/x-authorware-seg" => "aas",
            "application/x-abiword" => "abw",
            "application/pkix-attr-cert" => "ac",
            "application/vnd.americandynamics.acc" => "acc",
            "application/x-ace-compressed" => "ace",
            "application/vnd.acucobol" => "acu",
            "audio/adpcm" => "adp",
            "application/vnd.audiograph" => "aep",
            "application/vnd.ibm.modcap" => "afp",
            "application/vnd.ahead.space" => "ahead",
            "application/postscript" => "ai",
            "audio/x-aiff" => "aif",
            "application/vnd.adobe.air-application-installer-package+zip" => "air",
            "application/vnd.dvb.ait" => "ait",
            "application/vnd.amiga.ami" => "ami",
            "application/vnd.android.package-archive" => "apk",
            "application/x-ms-application" => "application",
            "application/vnd.lotus-approach" => "apr",
            "video/x-ms-asf" => "asf",
            "application/vnd.accpac.simply.aso" => "aso",
            "application/vnd.acucorp" => "atc",
            "application/atom+xml" => "atom, xml",
            "application/atomcat+xml" => "atomcat",
            "application/atomsvc+xml" => "atomsvc",
            "application/vnd.antix.game-component" => "atx",
            "audio/basic" => "au",
            "video/x-msvideo" => "avi",
            "application/applixware" => "aw",
            "application/vnd.airzip.filesecure.azf" => "azf",
            "application/vnd.airzip.filesecure.azs" => "azs",
            "application/vnd.amazon.ebook" => "azw",
            "application/x-bcpio" => "bcpio",
            "application/x-font-bdf" => "bdf",
            "application/vnd.syncml.dm+wbxml" => "bdm",
            "application/vnd.realvnc.bed" => "bed",
            "application/vnd.fujitsu.oasysprs" => "bh2",
            "application/octet-stream" => "bin",
            "application/vnd.bmi" => "bmi",
            "image/bmp" => "bmp",
            "application/vnd.previewsystems.box" => "box",
            "image/prs.btif" => "btif",
            "application/x-bzip" => "bz",
            "application/x-bzip2" => "bz2",
            "text/x-c" => "c",
            "application/vnd.cluetrust.cartomobile-config" => "c11amc",
            "application/vnd.cluetrust.cartomobile-config-pkg" => "c11amz",
            "application/vnd.clonk.c4group" => "c4g",
            "application/vnd.ms-cab-compressed" => "cab",
            "application/vnd.curl.car" => "car",
            "application/vnd.ms-pki.seccat" => "cat",
            "application/ccxml+xml," => "ccxml",
            "application/vnd.contact.cmsg" => "cdbcmsg",
            "application/vnd.mediastation.cdkey" => "cdkey",
            "application/cdmi-capability" => "cdmia",
            "application/cdmi-container" => "cdmic",
            "application/cdmi-domain" => "cdmid",
            "application/cdmi-object" => "cdmio",
            "application/cdmi-queue" => "cdmiq",
            "chemical/x-cdx" => "cdx",
            "application/vnd.chemdraw+xml" => "cdxml",
            "application/vnd.cinderella" => "cdy",
            "application/pkix-cert" => "cer",
            "image/cgm" => "cgm",
            "application/x-chat" => "chat",
            "application/vnd.ms-htmlhelp" => "chm",
            "application/vnd.kde.kchart" => "chrt",
            "chemical/x-cif" => "cif",
            "application/vnd.anser-web-certificate-issue-initiation" => "cii",
            "application/vnd.ms-artgalry" => "cil",
            "application/vnd.claymore" => "cla",
            "application/java-vm" => "class",
            "application/vnd.crick.clicker.keyboard" => "clkk",
            "application/vnd.crick.clicker.palette" => "clkp",
            "application/vnd.crick.clicker.template" => "clkt",
            "application/vnd.crick.clicker.wordbank" => "clkw",
            "application/vnd.crick.clicker" => "clkx",
            "application/x-msclip" => "clp",
            "application/vnd.cosmocaller" => "cmc",
            "chemical/x-cmdf" => "cmdf",
            "chemical/x-cml" => "cml",
            "application/vnd.yellowriver-custom-menu" => "cmp",
            "image/x-cmx" => "cmx",
            "application/vnd.rim.cod" => "cod",
            "application/x-cpio" => "cpio",
            "application/mac-compactpro" => "cpt",
            "application/x-mscardfile" => "crd",
            "application/pkix-crl" => "crl",
            "application/vnd.rig.cryptonote" => "cryptonote",
            "application/x-csh" => "csh",
            "chemical/x-csml" => "csml",
            "application/vnd.commonspace" => "csp",
            "text/css" => "css",
            "text/csv" => "csv",
            "application/cu-seeme" => "cu",
            "text/vnd.curl" => "curl",
            "application/prs.cww" => "cww",
            "model/vnd.collada+xml" => "dae",
            "application/vnd.mobius.daf" => "daf",
            "application/davmount+xml" => "davmount",
            "text/vnd.curl.dcurl" => "dcurl",
            "application/vnd.oma.dd2+xml" => "dd2",
            "application/vnd.fujixerox.ddd" => "ddd",
            "application/x-debian-package" => "deb",
            "application/x-x509-ca-cert" => "der",
            "application/vnd.dreamfactory" => "dfac",
            "application/x-director" => "dir",
            "application/vnd.mobius.dis" => "dis",
            "image/vnd.djvu" => "djvu",
            "application/x-apple-diskimage" => "dmg",
            "application/vnd.dna" => "dna",
            "application/msword" => "doc",
            "application/vnd.ms-word.document.macroenabled.12" => "docm",
            "application/vnd.openxmlformats-officedocument.wordprocessingml.document" => "docx",
            "application/vnd.ms-word.template.macroenabled.12" => "dotm",
            "application/vnd.openxmlformats-officedocument.wordprocessingml.template" => "dotx",
            "application/vnd.osgi.dp" => "dp",
            "application/vnd.dpgraph" => "dpg",
            "audio/vnd.dra" => "dra",
            "text/prs.lines.tag" => "dsc",
            "application/dssc+der" => "dssc",
            "application/x-dtbook+xml" => "dtb",
            "application/xml-dtd" => "dtd",
            "audio/vnd.dts" => "dts",
            "audio/vnd.dts.hd" => "dtshd",
            "application/x-dvi" => "dvi",
            "model/vnd.dwf" => "dwf",
            "image/vnd.dwg" => "dwg",
            "image/vnd.dxf" => "dxf",
            "application/vnd.spotfire.dxp" => "dxp",
            "audio/vnd.nuera.ecelp4800" => "ecelp4800",
            "audio/vnd.nuera.ecelp7470" => "ecelp7470",
            "audio/vnd.nuera.ecelp9600" => "ecelp9600",
            "application/vnd.novadigm.edm" => "edm",
            "application/vnd.novadigm.edx" => "edx",
            "application/vnd.picsel" => "efif",
            "application/vnd.pg.osasli" => "ei6",
            "message/rfc822" => "eml",
            "application/emma+xml" => "emma",
            "audio/vnd.digital-winds" => "eol",
            "application/vnd.ms-fontobject" => "eot",
            "application/epub+zip" => "epub",
            "application/ecmascript" => "es",
            "application/vnd.eszigno3+xml" => "es3",
            "application/vnd.epson.esf" => "esf",
            "text/x-setext" => "etx",
            "application/x-msdownload" => "exe",
            "application/exi" => "exi",
            "application/vnd.novadigm.ext" => "ext",
            "application/vnd.ezpix-album" => "ez2",
            "application/vnd.ezpix-package" => "ez3",
            "text/x-fortran" => "f",
            "video/x-f4v" => "f4v",
            "image/vnd.fastbidsheet" => "fbs",
            "application/vnd.isac.fcs" => "fcs",
            "application/vnd.fdf" => "fdf",
            "application/vnd.denovo.fcselayout-link" => "fe_launch",
            "application/vnd.fujitsu.oasysgp" => "fg5",
            "image/x-freehand" => "fh",
            "application/x-xfig" => "fig",
            "video/x-fli" => "fli",
            "application/vnd.micrografx.flo" => "flo",
            "video/x-flv" => "flv",
            "application/vnd.kde.kivio" => "flw",
            "text/vnd.fmi.flexstor" => "flx",
            "text/vnd.fly" => "fly",
            "application/vnd.framemaker" => "fm",
            "application/vnd.frogans.fnc" => "fnc",
            "image/vnd.fpx" => "fpx",
            "application/vnd.fsc.weblaunch" => "fsc",
            "image/vnd.fst" => "fst",
            "application/vnd.fluxtime.clip" => "ftc",
            "application/vnd.anser-web-funds-transfer-initiation" => "fti",
            "video/vnd.fvt" => "fvt",
            "application/vnd.adobe.fxp" => "fxp",
            "application/vnd.fuzzysheet" => "fzs",
            "application/vnd.geoplan" => "g2w",
            "image/g3fax" => "g3",
            "application/vnd.geospace" => "g3w",
            "application/vnd.groove-account" => "gac",
            "model/vnd.gdl" => "gdl",
            "application/vnd.dynageo" => "geo",
            "application/vnd.geometry-explorer" => "gex",
            "application/vnd.geogebra.file" => "ggb",
            "application/vnd.geogebra.tool" => "ggt",
            "application/vnd.groove-help" => "ghf",
            "image/gif" => "gif",
            "application/vnd.groove-identity-message" => "gim",
            "application/vnd.gmx" => "gmx",
            "application/x-gnumeric" => "gnumeric",
            "application/vnd.flographit" => "gph",
            "application/vnd.grafeq" => "gqf",
            "application/srgs" => "gram",
            "application/vnd.groove-injector" => "grv",
            "application/srgs+xml" => "grxml",
            "application/x-font-ghostscript" => "gsf",
            "application/x-gtar" => "gtar",
            "application/vnd.groove-tool-message" => "gtm",
            "model/vnd.gtw" => "gtw",
            "text/vnd.graphviz" => "gv",
            "application/vnd.geonext" => "gxt",
            "video/h261" => "h261",
            "video/h263" => "h263",
            "video/h264" => "h264",
            "application/vnd.hal+xml" => "hal",
            "application/vnd.hbci" => "hbci",
            "application/x-hdf" => "hdf",
            "application/winhlp" => "hlp",
            "application/vnd.hp-hpgl" => "hpgl",
            "application/vnd.hp-hpid" => "hpid",
            "application/vnd.hp-hps" => "hps",
            "application/mac-binhex40" => "hqx",
            "application/vnd.kenameaapp" => "htke",
            "text/html" => "html",
            "application/vnd.yamaha.hv-dic" => "hvd",
            "application/vnd.yamaha.hv-voice" => "hvp",
            "application/vnd.yamaha.hv-script" => "hvs",
            "application/vnd.intergeo" => "i2g",
            "application/vnd.iccprofile" => "icc",
            "x-conference/x-cooltalk" => "ice",
            "image/x-icon" => "ico",
            "text/calendar" => "ics",
            "image/ief" => "ief",
            "application/vnd.shana.informed.formdata" => "ifm",
            "application/vnd.igloader" => "igl",
            "application/vnd.insors.igm" => "igm",
            "model/iges" => "igs",
            "application/vnd.micrografx.igx" => "igx",
            "application/vnd.shana.informed.interchange" => "iif",
            "application/vnd.accpac.simply.imp" => "imp",
            "application/vnd.ms-ims" => "ims",
            "application/ipfix" => "ipfix",
            "application/vnd.shana.informed.package" => "ipk",
            "application/vnd.ibm.rights-management" => "irm",
            "application/vnd.irepository.package+xml" => "irp",
            "application/vnd.shana.informed.formtemplate" => "itp",
            "application/vnd.immervision-ivp" => "ivp",
            "application/vnd.immervision-ivu" => "ivu",
            "text/vnd.sun.j2me.app-descriptor" => "jad",
            "application/vnd.jam" => "jam",
            "application/java-archive" => "jar",
            "text/x-java-source,java" => "java",
            "application/vnd.jisp" => "jisp",
            "application/vnd.hp-jlyt" => "jlt",
            "application/x-java-jnlp-file" => "jnlp",
            "application/vnd.joost.joda-archive" => "joda",
            "image/jpeg" => "jpeg, jpg",
            "image/x-citrix-jpeg" => "jpeg, jpg",
            "video/jpeg" => "jpgv",
            "video/jpm" => "jpm",
            "application/javascript" => "js",
            "application/json" => "json",
            "application/vnd.kde.karbon" => "karbon",
            "application/vnd.kde.kformula" => "kfo",
            "application/vnd.kidspiration" => "kia",
            "application/vnd.google-earth.kml+xml" => "kml",
            "application/vnd.google-earth.kmz" => "kmz",
            "application/vnd.kinar" => "kne",
            "application/vnd.kde.kontour" => "kon",
            "application/vnd.kde.kpresenter" => "kpr",
            "application/vnd.kde.kspread" => "ksp",
            "image/ktx" => "ktx",
            "application/vnd.kahootz" => "ktz",
            "application/vnd.kde.kword" => "kwd",
            "application/vnd.las.las+xml" => "lasxml",
            "application/x-latex" => "latex",
            "application/vnd.llamagraphics.life-balance.desktop" => "lbd",
            "application/vnd.llamagraphics.life-balance.exchange+xml" => "lbe",
            "application/vnd.hhe.lesson-player" => "les",
            "application/vnd.route66.link66+xml" => "link66",
            "application/vnd.ms-lrm" => "lrm",
            "application/vnd.frogans.ltf" => "ltf",
            "audio/vnd.lucent.voice" => "lvp",
            "application/vnd.lotus-wordpro" => "lwp",
            "application/mp21" => "m21",
            "audio/x-mpegurl" => "m3u",
            "application/vnd.apple.mpegurl" => "m3u8",
            "video/x-m4v" => "m4v",
            "application/mathematica" => "ma",
            "application/mads+xml" => "mads",
            "application/vnd.ecowin.chart" => "mag",
            "application/mathml+xml" => "mathml",
            "application/vnd.mobius.mbk" => "mbk",
            "application/mbox" => "mbox",
            "application/vnd.medcalcdata" => "mc1",
            "application/vnd.mcd" => "mcd",
            "text/vnd.curl.mcurl" => "mcurl",
            "application/x-msaccess" => "mdb",
            "image/vnd.ms-modi" => "mdi",
            "application/metalink4+xml" => "meta4",
            "application/mets+xml" => "mets",
            "application/vnd.mfmp" => "mfm",
            "application/vnd.osgeo.mapguide.package" => "mgp",
            "application/vnd.proteus.magazine" => "mgz",
            "audio/midi" => "mid",
            "application/vnd.mif" => "mif",
            "video/mj2" => "mj2",
            "application/vnd.dolby.mlp" => "mlp",
            "application/vnd.chipnuts.karaoke-mmd" => "mmd",
            "application/vnd.smaf" => "mmf",
            "image/vnd.fujixerox.edmics-mmr" => "mmr",
            "application/x-msmoney" => "mny",
            "application/mods+xml" => "mods",
            "video/x-sgi-movie" => "movie",
            "application/mp4" => "mp4",
            "video/mp4" => "mp4",
            "audio/mp4" => "mp4a",
            "application/vnd.mophun.certificate" => "mpc",
            "video/mpeg" => "mpeg",
            "audio/mpeg" => "mpga",
            "application/vnd.apple.installer+xml" => "mpkg",
            "application/vnd.blueice.multipass" => "mpm",
            "application/vnd.mophun.application" => "mpn",
            "application/vnd.ms-project" => "mpp",
            "application/vnd.ibm.minipay" => "mpy",
            "application/vnd.mobius.mqy" => "mqy",
            "application/marc" => "mrc",
            "application/marcxml+xml" => "mrcx",
            "application/mediaservercontrol+xml" => "mscml",
            "application/vnd.mseq" => "mseq",
            "application/vnd.epson.msf" => "msf",
            "model/mesh" => "msh",
            "application/vnd.mobius.msl" => "msl",
            "application/vnd.muvee.style" => "msty",
            "model/vnd.mts" => "mts",
            "application/vnd.musician" => "mus",
            "application/vnd.recordare.musicxml+xml" => "musicxml",
            "application/x-msmediaview" => "mvb",
            "application/vnd.mfer" => "mwf",
            "application/mxf" => "mxf",
            "application/vnd.recordare.musicxml" => "mxl",
            "application/xv+xml" => "mxml",
            "application/vnd.triscape.mxs" => "mxs",
            "video/vnd.mpegurl" => "mxu",
            "application/vnd.nokia.n-gage.symbian.install" => "n-gage",
            "text/n3" => "n3",
            "application/vnd.wolfram.player" => "nbp",
            "application/x-netcdf" => "nc",
            "application/x-dtbncx+xml" => "ncx",
            "application/vnd.nokia.n-gage.data" => "ngdat",
            "application/vnd.neurolanguage.nlu" => "nlu",
            "application/vnd.enliven" => "nml",
            "application/vnd.noblenet-directory" => "nnd",
            "application/vnd.noblenet-sealer" => "nns",
            "application/vnd.noblenet-web" => "nnw",
            "image/vnd.net-fpx" => "npx",
            "application/vnd.lotus-notes" => "nsf",
            "application/vnd.fujitsu.oasys2" => "oa2",
            "application/vnd.fujitsu.oasys3" => "oa3",
            "application/vnd.fujitsu.oasys" => "oas",
            "application/x-msbinder" => "obd",
            "application/oda" => "oda",
            "application/vnd.oasis.opendocument.database" => "odb",
            "application/vnd.oasis.opendocument.chart" => "odc",
            "application/vnd.oasis.opendocument.formula" => "odf",
            "application/vnd.oasis.opendocument.formula-template" => "odft",
            "application/vnd.oasis.opendocument.graphics" => "odg",
            "application/vnd.oasis.opendocument.image" => "odi",
            "application/vnd.oasis.opendocument.text-master" => "odm",
            "application/vnd.oasis.opendocument.presentation" => "odp",
            "application/vnd.oasis.opendocument.spreadsheet" => "ods",
            "application/vnd.oasis.opendocument.text" => "odt",
            "audio/ogg" => "oga",
            "video/ogg" => "ogv",
            "application/ogg" => "ogx",
            "application/onenote" => "onetoc",
            "application/oebps-package+xml" => "opf",
            "application/vnd.lotus-organizer" => "org",
            "application/vnd.yamaha.openscoreformat" => "osf",
            "application/vnd.yamaha.openscoreformat.osfpvg+xml" => "osfpvg",
            "application/vnd.oasis.opendocument.chart-template" => "otc",
            "application/x-font-otf" => "otf",
            "application/vnd.oasis.opendocument.graphics-template" => "otg",
            "application/vnd.oasis.opendocument.text-web" => "oth",
            "application/vnd.oasis.opendocument.image-template" => "oti",
            "application/vnd.oasis.opendocument.presentation-template" => "otp",
            "application/vnd.oasis.opendocument.spreadsheet-template" => "ots",
            "application/vnd.oasis.opendocument.text-template" => "ott",
            "application/vnd.openofficeorg.extension" => "oxt",
            "text/x-pascal" => "p",
            "application/pkcs10" => "p10",
            "application/x-pkcs12" => "p12",
            "application/x-pkcs7-certificates" => "p7b",
            "application/pkcs7-mime" => "p7m",
            "application/x-pkcs7-certreqresp" => "p7r",
            "application/pkcs7-signature" => "p7s",
            "application/pkcs8" => "p8",
            "text/plain-bas" => "par",
            "application/vnd.pawaafile" => "paw",
            "application/vnd.powerbuilder6" => "pbd",
            "image/x-portable-bitmap" => "pbm",
            "application/x-font-pcf" => "pcf",
            "application/vnd.hp-pcl" => "pcl",
            "application/vnd.hp-pclxl" => "pclxl",
            "application/vnd.curl.pcurl" => "pcurl",
            "image/x-pcx" => "pcx",
            "application/vnd.palm" => "pdb",
            "application/pdf" => "pdf",
            "application/x-font-type1" => "pfa",
            "application/font-tdpfr" => "pfr",
            "image/x-portable-graymap" => "pgm",
            "application/x-chess-pgn" => "pgn",
            "application/pgp-encrypted" => "pgp",
            "application/pgp-signature" => "pgp",
            "image/x-pict" => "pic",
            "image/pjpeg" => "pjpeg",
            "application/pkixcmp" => "pki",
            "application/pkix-pkipath" => "pkipath",
            "application/vnd.3gpp.pic-bw-large" => "plb",
            "application/vnd.mobius.plc" => "plc",
            "application/vnd.pocketlearn" => "plf",
            "application/pls+xml" => "pls",
            "application/vnd.ctc-posml" => "pml",
            "image/png" => "png",
            "image/x-citrix-png" => "png",
            "image/x-png" => "png",
            "image/x-portable-anymap" => "pnm",
            "application/vnd.macports.portpkg" => "portpkg",
            "application/vnd.ms-powerpoint.template.macroenabled.12" => "potm",
            "application/vnd.openxmlformats-officedocument.presentationml.template" => "potx",
            "application/vnd.ms-powerpoint.addin.macroenabled.12" => "ppam",
            "application/vnd.cups-ppd" => "ppd",
            "image/x-portable-pixmap" => "ppm",
            "application/vnd.ms-powerpoint.slideshow.macroenabled.12" => "ppsm",
            "application/vnd.openxmlformats-officedocument.presentationml.slideshow" => "ppsx",
            "application/vnd.ms-powerpoint" => "ppt",
            "application/vnd.ms-powerpoint.presentation.macroenabled.12" => "pptm",
            "application/vnd.openxmlformats-officedocument.presentationml.presentation" => "pptx",
            "application/x-mobipocket-ebook" => "prc",
            "application/vnd.lotus-freelance" => "pre",
            "application/pics-rules" => "prf",
            "application/vnd.3gpp.pic-bw-small" => "psb",
            "image/vnd.adobe.photoshop" => "psd",
            "application/x-font-linux-psf" => "psf",
            "application/pskc+xml" => "pskcxml",
            "application/vnd.pvi.ptid1" => "ptid",
            "application/x-mspublisher" => "pub",
            "application/vnd.3gpp.pic-bw-var" => "pvb",
            "application/vnd.3m.post-it-notes" => "pwn",
            "audio/vnd.ms-playready.media.pya" => "pya",
            "video/vnd.ms-playready.media.pyv" => "pyv",
            "application/vnd.epson.quickanime" => "qam",
            "application/vnd.intu.qbo" => "qbo",
            "application/vnd.intu.qfx" => "qfx",
            "application/vnd.publishare-delta-tree" => "qps",
            "video/quicktime" => "qt",
            "application/vnd.quark.quarkxpress" => "qxd",
            "audio/x-pn-realaudio" => "ram",
            "application/x-rar-compressed" => "rar",
            "image/x-cmu-raster" => "ras",
            "application/vnd.ipunplugged.rcprofile" => "rcprofile",
            "application/rdf+xml" => "rdf",
            "application/vnd.data-vision.rdz" => "rdz",
            "application/vnd.businessobjects" => "rep",
            "application/x-dtbresource+xml" => "res",
            "image/x-rgb" => "rgb",
            "application/reginfo+xml" => "rif",
            "audio/vnd.rip" => "rip",
            "application/resource-lists+xml" => "rl",
            "image/vnd.fujixerox.edmics-rlc" => "rlc",
            "application/resource-lists-diff+xml" => "rld",
            "application/vnd.rn-realmedia" => "rm",
            "audio/x-pn-realaudio-plugin" => "rmp",
            "application/vnd.jcp.javame.midlet-rms" => "rms",
            "application/relax-ng-compact-syntax" => "rnc",
            "application/vnd.cloanto.rp9" => "rp9",
            "application/vnd.nokia.radio-presets" => "rpss",
            "application/vnd.nokia.radio-preset" => "rpst",
            "application/sparql-query" => "rq",
            "application/rls-services+xml" => "rs",
            "application/rsd+xml" => "rsd",
            "application/rss+xml" => "rss, xml",
            "application/rtf" => "rtf",
            "text/richtext" => "rtx",
            "text/x-asm" => "s",
            "application/vnd.yamaha.smaf-audio" => "saf",
            "application/sbml+xml" => "sbml",
            "application/vnd.ibm.secure-container" => "sc",
            "application/x-msschedule" => "scd",
            "application/vnd.lotus-screencam" => "scm",
            "application/scvp-cv-request" => "scq",
            "application/scvp-cv-response" => "scs",
            "text/vnd.curl.scurl" => "scurl",
            "application/vnd.stardivision.draw" => "sda",
            "application/vnd.stardivision.calc" => "sdc",
            "application/vnd.stardivision.impress" => "sdd",
            "application/vnd.solent.sdkm+xml" => "sdkm",
            "application/sdp" => "sdp",
            "application/vnd.stardivision.writer" => "sdw",
            "application/vnd.seemail" => "see",
            "application/vnd.fdsn.seed" => "seed",
            "application/vnd.sema" => "sema",
            "application/vnd.semd" => "semd",
            "application/vnd.semf" => "semf",
            "application/java-serialized-object" => "ser",
            "application/set-payment-initiation" => "setpay",
            "application/set-registration-initiation" => "setreg",
            "application/vnd.hydrostatix.sof-data" => "sfd-hdstx",
            "application/vnd.spotfire.sfs" => "sfs",
            "application/vnd.stardivision.writer-global" => "sgl",
            "text/sgml" => "sgml",
            "application/x-sh" => "sh",
            "application/x-shar" => "shar",
            "application/shf+xml" => "shf",
            "application/vnd.symbian.install" => "sis",
            "application/x-stuffit" => "sit",
            "application/x-stuffitx" => "sitx",
            "application/vnd.koan" => "skp",
            "application/vnd.ms-powerpoint.slide.macroenabled.12" => "sldm",
            "application/vnd.openxmlformats-officedocument.presentationml.slide" => "sldx",
            "application/vnd.epson.salt" => "slt",
            "application/vnd.stepmania.stepchart" => "sm",
            "application/vnd.stardivision.math" => "smf",
            "application/smil+xml" => "smi",
            "application/x-font-snf" => "snf",
            "application/vnd.yamaha.smaf-phrase" => "spf",
            "application/x-futuresplash" => "spl",
            "text/vnd.in3d.spot" => "spot",
            "application/scvp-vp-response" => "spp",
            "application/scvp-vp-request" => "spq",
            "application/x-wais-source" => "src",
            "application/sru+xml" => "sru",
            "application/sparql-results+xml" => "srx",
            "application/vnd.kodak-descriptor" => "sse",
            "application/vnd.epson.ssf" => "ssf",
            "application/ssml+xml" => "ssml",
            "application/vnd.sailingtracker.track" => "st",
            "application/vnd.sun.xml.calc.template" => "stc",
            "application/vnd.sun.xml.draw.template" => "std",
            "application/vnd.wt.stf" => "stf",
            "application/vnd.sun.xml.impress.template" => "sti",
            "application/hyperstudio" => "stk",
            "application/vnd.ms-pki.stl" => "stl",
            "application/vnd.pg.format" => "str",
            "application/vnd.sun.xml.writer.template" => "stw",
            "image/vnd.dvb.subtitle" => "sub",
            "application/vnd.sus-calendar" => "sus",
            "application/x-sv4cpio" => "sv4cpio",
            "application/x-sv4crc" => "sv4crc",
            "application/vnd.dvb.service" => "svc",
            "application/vnd.svd" => "svd",
            "image/svg+xml" => "svg",
            "application/x-shockwave-flash" => "swf",
            "application/vnd.aristanetworks.swi" => "swi",
            "application/vnd.sun.xml.calc" => "sxc",
            "application/vnd.sun.xml.draw" => "sxd",
            "application/vnd.sun.xml.writer.global" => "sxg",
            "application/vnd.sun.xml.impress" => "sxi",
            "application/vnd.sun.xml.math" => "sxm",
            "application/vnd.sun.xml.writer" => "sxw",
            "text/troff" => "t",
            "application/vnd.tao.intent-module-archive" => "tao",
            "application/x-tar" => "tar",
            "application/vnd.3gpp2.tcap" => "tcap",
            "application/x-tcl" => "tcl",
            "application/vnd.smart.teacher" => "teacher",
            "application/tei+xml" => "tei",
            "application/x-tex" => "tex",
            "application/x-texinfo" => "texinfo",
            "application/thraud+xml" => "tfi",
            "application/x-tex-tfm" => "tfm",
            "application/vnd.ms-officetheme" => "thmx",
            "image/tiff" => "tiff",
            "application/vnd.tmobile-livetv" => "tmo",
            "application/x-bittorrent" => "torrent",
            "application/vnd.groove-tool-template" => "tpl",
            "application/vnd.trid.tpt" => "tpt",
            "application/vnd.trueapp" => "tra",
            "application/x-msterminal" => "trm",
            "application/timestamped-data" => "tsd",
            "text/tab-separated-values" => "tsv",
            "application/x-font-ttf" => "ttf",
            "text/turtle" => "ttl",
            "application/vnd.simtech-mindmapper" => "twd",
            "application/vnd.genomatix.tuxedo" => "txd",
            "application/vnd.mobius.txf" => "txf",
            "text/plain" => "txt",
            "application/vnd.ufdl" => "ufd",
            "application/vnd.umajin" => "umj",
            "application/vnd.unity" => "unityweb",
            "application/vnd.uoml+xml" => "uoml",
            "text/uri-list" => "uri",
            "application/x-ustar" => "ustar",
            "application/vnd.uiq.theme" => "utz",
            "text/x-uuencode" => "uu",
            "audio/vnd.dece.audio" => "uva",
            "video/vnd.dece.hd" => "uvh",
            "image/vnd.dece.graphic" => "uvi",
            "video/vnd.dece.mobile" => "uvm",
            "video/vnd.dece.pd" => "uvp",
            "video/vnd.dece.sd" => "uvs",
            "video/vnd.uvvu.mp4" => "uvu",
            "video/vnd.dece.video" => "uvv",
            "application/x-cdlink" => "vcd",
            "text/x-vcard" => "vcf",
            "application/vnd.groove-vcard" => "vcg",
            "text/x-vcalendar" => "vcs",
            "application/vnd.vcx" => "vcx",
            "application/vnd.visionary" => "vis",
            "video/vnd.vivo" => "viv",
            "application/vnd.visio" => "vsd",
            "application/vnd.visio2013" => "vsdx",
            "application/vnd.vsf" => "vsf",
            "model/vnd.vtu" => "vtu",
            "application/voicexml+xml" => "vxml",
            "application/x-doom" => "wad",
            "audio/x-wav" => "wav",
            "audio/x-ms-wax" => "wax",
            "image/vnd.wap.wbmp" => "wbmp",
            "application/vnd.criticaltools.wbs+xml" => "wbs",
            "application/vnd.wap.wbxml" => "wbxml",
            "audio/webm" => "weba",
            "video/webm" => "webm",
            "image/webp" => "webp",
            "application/vnd.pmi.widget" => "wg",
            "application/widget" => "wgt",
            "video/x-ms-wm" => "wm",
            "audio/x-ms-wma" => "wma",
            "application/x-ms-wmd" => "wmd",
            "application/x-msmetafile" => "wmf",
            "text/vnd.wap.wml" => "wml",
            "application/vnd.wap.wmlc" => "wmlc",
            "text/vnd.wap.wmlscript" => "wmls",
            "application/vnd.wap.wmlscriptc" => "wmlsc",
            "video/x-ms-wmv" => "wmv",
            "video/x-ms-wmx" => "wmx",
            "application/x-ms-wmz" => "wmz",
            "application/x-font-woff" => "woff",
            "application/vnd.wordperfect" => "wpd",
            "application/vnd.ms-wpl" => "wpl",
            "application/vnd.ms-works" => "wps",
            "application/vnd.wqd" => "wqd",
            "application/x-mswrite" => "wri",
            "model/vrml" => "wrl",
            "application/wsdl+xml" => "wsdl",
            "application/wspolicy+xml" => "wspolicy",
            "application/vnd.webturbo" => "wtb",
            "video/x-ms-wvx" => "wvx",
            "application/vnd.hzn-3d-crossword" => "x3d",
            "application/x-silverlight-app" => "xap",
            "application/vnd.xara" => "xar",
            "application/x-ms-xbap" => "xbap",
            "application/vnd.fujixerox.docuworks.binder" => "xbd",
            "image/x-xbitmap" => "xbm",
            "application/xcap-diff+xml" => "xdf",
            "application/vnd.syncml.dm+xml" => "xdm",
            "application/vnd.adobe.xdp+xml" => "xdp",
            "application/dssc+xml" => "xdssc",
            "application/vnd.fujixerox.docuworks" => "xdw",
            "application/xenc+xml" => "xenc",
            "application/patch-ops-error+xml" => "xer",
            "application/vnd.adobe.xfdf" => "xfdf",
            "application/vnd.xfdl" => "xfdl",
            "application/xhtml+xml" => "xhtml",
            "image/vnd.xiff" => "xif",
            "application/vnd.ms-excel.addin.macroenabled.12" => "xlam",
            "application/vnd.ms-excel" => "xls",
            "application/vnd.ms-excel.sheet.binary.macroenabled.12" => "xlsb",
            "application/vnd.ms-excel.sheet.macroenabled.12" => "xlsm",
            "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" => "xlsx",
            "application/vnd.ms-excel.template.macroenabled.12" => "xltm",
            "application/vnd.openxmlformats-officedocument.spreadsheetml.template" => "xltx",
            "application/xml" => "xml",
            "application/vnd.olpc-sugar" => "xo",
            "application/xop+xml" => "xop",
            "application/x-xpinstall" => "xpi",
            "image/x-xpixmap" => "xpm",
            "application/vnd.is-xpr" => "xpr",
            "application/vnd.ms-xpsdocument" => "xps",
            "application/vnd.intercon.formnet" => "xpw",
            "application/xslt+xml" => "xslt",
            "application/vnd.syncml+xml" => "xsm",
            "application/xspf+xml" => "xspf",
            "application/vnd.mozilla.xul+xml" => "xul",
            "image/x-xwindowdump" => "xwd",
            "chemical/x-xyz" => "xyz",
            "text/yaml" => "yaml",
            "application/yang" => "yang",
            "application/yin+xml" => "yin",
            "application/vnd.zzazz.deck+xml" => "zaz",
            "application/zip" => "zip",
            "application/vnd.zul" => "zir",
            "application/vnd.handheld-entertainment+xml" => "zmm",
            "" => "",
            "Возможный миме тип" => "Расширение файла",
            "x-world/x-3dmf" => "3dm",
            "x-world/x-3dmf" => "3dmf",
            "application/octet-stream" => "a",
            "application/x-authorware-bin" => "aab",
            "application/x-authorware-map" => "aam",
            "application/x-authorware-seg" => "aas",
            "text/vnd.abc" => "abc",
            "text/html" => "acgi",
            "video/animaflex" => "afl",
            "application/postscript" => "ai",
            "audio/aiff" => "aif",
            "audio/x-aiff" => "aif",
            "audio/aiff" => "aifc",
            "audio/x-aiff" => "aifc",
            "audio/aiff" => "aiff",
            "audio/x-aiff" => "aiff",
            "application/x-aim" => "aim",
            "text/x-audiosoft-intra" => "aip",
            "application/x-navi-animation" => "ani",
            "application/x-nokia-9000-communicator-add-on-software" => "aos",
            "application/mime" => "aps",
            "application/octet-stream" => "arc",
            "application/arj" => "arj",
            "application/octet-stream" => "arj",
            "image/x-jg" => "art",
            "video/x-ms-asf" => "asf",
            "text/x-asm" => "asm",
            "text/asp" => "asp",
            "application/x-mplayer2" => "asx",
            "video/x-ms-asf" => "asx",
            "video/x-ms-asf-plugin" => "asx",
            "audio/basic" => "au",
            "audio/x-au" => "au",
            "application/x-troff-msvideo" => "avi",
            "video/avi" => "avi",
            "video/msvideo" => "avi",
            "video/x-msvideo" => "avi",
            "video/avs-video" => "avs",
            "application/x-bcpio" => "bcpio",
            "application/mac-binary" => "bin",
            "application/macbinary" => "bin",
            "application/octet-stream" => "bin",
            "application/x-binary" => "bin",
            "application/x-macbinary" => "bin",
            "image/bmp" => "bm",
            "image/bmp" => "bmp",
            "image/x-windows-bmp" => "bmp",
            "application/book" => "boo",
            "application/book" => "book",
            "application/x-bzip2" => "boz",
            "application/x-bsh" => "bsh",
            "application/x-bzip" => "bz",
            "application/x-bzip2" => "bz2",
            "text/plain" => "c",
            "text/x-c" => "c",
            "text/plain" => "c++",
            "application/vnd.ms-pki.seccat" => "cat",
            "text/plain" => "cc",
            "text/x-c" => "cc",
            "application/clariscad" => "ccad",
            "application/x-cocoa" => "cco",
            "application/cdf" => "cdf",
            "application/x-cdf" => "cdf",
            "application/x-netcdf" => "cdf",
            "application/pkix-cert" => "cer",
            "application/x-x509-ca-cert" => "cer",
            "application/x-chat" => "cha",
            "application/x-chat" => "chat",
            "application/java" => "class",
            "application/java-byte-code" => "class",
            "application/x-java-class" => "class",
            "application/octet-stream" => "com",
            "text/plain" => "com",
            "text/plain" => "conf",
            "application/x-cpio" => "cpio",
            "text/x-c" => "cpp",
            "application/mac-compactpro" => "cpt",
            "application/x-compactpro" => "cpt",
            "application/x-cpt" => "cpt",
            "application/pkcs-crl" => "crl",
            "application/pkix-crl" => "crl",
            "application/pkix-cert" => "crt",
            "application/x-x509-ca-cert" => "crt",
            "application/x-x509-user-cert" => "crt",
            "application/x-csh" => "csh",
            "text/x-script.csh" => "csh",
            "application/x-pointplus" => "css",
            "text/css" => "css",
            "text/plain" => "cxx",
            "application/x-director" => "dcr",
            "application/x-deepv" => "deepv",
            "text/plain" => "def",
            "application/x-x509-ca-cert" => "der",
            "video/x-dv" => "dif",
            "application/x-director" => "dir",
            "video/dl" => "dl",
            "video/x-dl" => "dl",
            "application/msword" => "doc",
            "application/msword" => "dot",
            "application/commonground" => "dp",
            "application/drafting" => "drw",
            "application/octet-stream" => "dump",
            "video/x-dv" => "dv",
            "application/x-dvi" => "dvi",
            "drawing/x-dwf (old)" => "dwf",
            "model/vnd.dwf" => "dwf",
            "application/acad" => "dwg",
            "image/vnd.dwg" => "dwg",
            "image/x-dwg" => "dwg",
            "application/dxf" => "dxf",
            "image/vnd.dwg" => "dxf",
            "image/x-dwg" => "dxf",
            "application/x-director" => "dxr",
            "text/x-script.elisp" => "el",
            "application/x-bytecode.elisp (compiled elisp)" => "elc",
            "application/x-elc" => "elc",
            "application/x-envoy" => "env",
            "application/postscript" => "eps",
            "application/x-esrehber" => "es",
            "text/x-setext" => "etx",
            "application/envoy" => "evy",
            "application/x-envoy" => "evy",
            "application/octet-stream" => "exe",
            "text/plain" => "f",
            "text/x-fortran" => "f",
            "text/x-fortran" => "f77",
            "text/plain" => "f90",
            "text/x-fortran" => "f90",
            "application/vnd.fdf" => "fdf",
            "application/fractals" => "fif",
            "image/fif" => "fif",
            "video/fli" => "fli",
            "video/x-fli" => "fli",
            "image/florian" => "flo",
            "text/vnd.fmi.flexstor" => "flx",
            "video/x-atomic3d-feature" => "fmf",
            "text/plain" => "for",
            "text/x-fortran" => "for",
            "image/vnd.fpx" => "fpx",
            "image/vnd.net-fpx" => "fpx",
            "application/freeloader" => "frl",
            "audio/make" => "funk",
            "text/plain" => "g",
            "image/g3fax" => "g3",
            "image/gif" => "gif",
            "video/gl" => "gl",
            "video/x-gl" => "gl",
            "audio/x-gsm" => "gsd",
            "audio/x-gsm" => "gsm",
            "application/x-gsp" => "gsp",
            "application/x-gss" => "gss",
            "application/x-gtar" => "gtar",
            "application/x-compressed" => "gz",
            "application/x-gzip" => "gz",
            "application/x-gzip" => "gzip",
            "multipart/x-gzip" => "gzip",
            "text/plain" => "h",
            "text/x-h" => "h",
            "application/x-hdf" => "hdf",
            "application/x-helpfile" => "help",
            "application/vnd.hp-hpgl" => "hgl",
            "text/plain" => "hh",
            "text/x-h" => "hh",
            "text/x-script" => "hlb",
            "application/hlp" => "hlp",
            "application/x-helpfile" => "hlp",
            "application/x-winhelp" => "hlp",
            "application/vnd.hp-hpgl" => "hpg",
            "application/vnd.hp-hpgl" => "hpgl",
            "application/binhex" => "hqx",
            "application/binhex4" => "hqx",
            "application/mac-binhex" => "hqx",
            "application/mac-binhex40" => "hqx",
            "application/x-binhex40" => "hqx",
            "application/x-mac-binhex40" => "hqx",
            "application/hta" => "hta",
            "text/x-component" => "htc",
            "text/html" => "htm",
            "text/html" => "html",
            "text/html" => "htmls",
            "text/webviewhtml" => "htt",
            "text/html" => "htx",
            "x-conference/x-cooltalk" => "ice",
            "image/x-icon" => "ico",
            "text/plain" => "idc",
            "image/ief" => "ief",
            "image/ief" => "iefs",
            "application/iges" => "iges",
            "model/iges" => "iges",
            "application/iges" => "igs",
            "model/iges" => "igs",
            "application/x-ima" => "ima",
            "application/x-httpd-imap" => "imap",
            "application/inf" => "inf",
            "application/x-internett-signup" => "ins",
            "application/x-ip2" => "ip",
            "video/x-isvideo" => "isu",
            "audio/it" => "it",
            "application/x-inventor" => "iv",
            "i-world/i-vrml" => "ivr",
            "application/x-livescreen" => "ivy",
            "audio/x-jam" => "jam",
            "text/plain" => "jav",
            "text/x-java-source" => "jav",
            "text/plain" => "java",
            "text/x-java-source" => "java",
            "application/x-java-commerce" => "jcm",
            "image/jpeg" => "jfif",
            "image/pjpeg" => "jfif",
            "image/jpeg" => "jfif-tbnl",
            "image/jpeg" => "jpe",
            "image/pjpeg" => "jpe",
            "image/jpeg" => "jpeg",
            "image/pjpeg" => "jpeg",
            "image/jpeg" => "jpg",
            "image/pjpeg" => "jpg",
            "image/x-jps" => "jps",
            "application/x-javascript" => "js",
            "application/javascript" => "js",
            "application/ecmascript" => "js",
            "text/javascript" => "js",
            "text/ecmascript" => "js",
            "image/jutvision" => "jut",
            "audio/midi" => "kar",
            "music/x-karaoke" => "kar",
            "application/x-ksh" => "ksh",
            "text/x-script.ksh" => "ksh",
            "audio/nspaudio" => "la",
            "audio/x-nspaudio" => "la",
            "audio/x-liveaudio" => "lam",
            "application/x-latex" => "latex",
            "application/lha" => "lha",
            "application/octet-stream" => "lha",
            "application/x-lha" => "lha",
            "application/octet-stream" => "lhx",
            "text/plain" => "list",
            "audio/nspaudio" => "lma",
            "audio/x-nspaudio" => "lma",
            "text/plain" => "log",
            "application/x-lisp" => "lsp",
            "text/x-script.lisp" => "lsp",
            "text/plain" => "lst",
            "text/x-la-asf" => "lsx",
            "application/x-latex" => "ltx",
            "application/octet-stream" => "lzh",
            "application/x-lzh" => "lzh",
            "application/lzx" => "lzx",
            "application/octet-stream" => "lzx",
            "application/x-lzx" => "lzx",
            "text/plain" => "m",
            "text/x-m" => "m",
            "video/mpeg" => "m1v",
            "audio/mpeg" => "m2a",
            "video/mpeg" => "m2v",
            "audio/x-mpequrl" => "m3u",
            "application/x-troff-man" => "man",
            "application/x-navimap" => "map",
            "text/plain" => "mar",
            "application/mbedlet" => "mbd",
            "application/x-magic-cap-package-1.0" => "mc$",
            "application/mcad" => "mcd",
            "application/x-mathcad" => "mcd",
            "image/vasa" => "mcf",
            "text/mcf" => "mcf",
            "application/netmc" => "mcp",
            "application/x-troff-me" => "me",
            "message/rfc822" => "mht",
            "message/rfc822" => "mhtml",
            "application/x-midi" => "mid",
            "audio/midi" => "mid",
            "audio/x-mid" => "mid",
            "audio/x-midi" => "mid",
            "music/crescendo" => "mid",
            "x-music/x-midi" => "mid",
            "application/x-midi" => "midi",
            "audio/midi" => "midi",
            "audio/x-mid" => "midi",
            "audio/x-midi" => "midi",
            "music/crescendo" => "midi",
            "x-music/x-midi" => "midi",
            "application/x-frame" => "mif",
            "application/x-mif" => "mif",
            "message/rfc822" => "mime",
            "www/mime" => "mime",
            "audio/x-vnd.audioexplosion.mjuicemediafile" => "mjf",
            "video/x-motion-jpeg" => "mjpg",
            "application/base64" => "mm",
            "application/x-meme" => "mm",
            "application/base64" => "mme",
            "audio/mod" => "mod",
            "audio/x-mod" => "mod",
            "video/quicktime" => "moov",
            "video/quicktime" => "mov",
            "video/x-sgi-movie" => "movie",
            "audio/mpeg" => "mp2",
            "audio/x-mpeg" => "mp2",
            "video/mpeg" => "mp2",
            "video/x-mpeg" => "mp2",
            "video/x-mpeq2a" => "mp2",
            "audio/mpeg3" => "mp3",
            "audio/x-mpeg-3" => "mp3",
            "video/mpeg" => "mp3",
            "video/x-mpeg" => "mp3",
            "audio/mpeg" => "mpa",
            "video/mpeg" => "mpa",
            "application/x-project" => "mpc",
            "video/mpeg" => "mpe",
            "video/mpeg" => "mpeg",
            "audio/mpeg" => "mpg",
            "video/mpeg" => "mpg",
            "audio/mpeg" => "mpga",
            "application/vnd.ms-project" => "mpp",
            "application/x-project" => "mpt",
            "application/x-project" => "mpv",
            "application/x-project" => "mpx",
            "application/marc" => "mrc",
            "application/x-troff-ms" => "ms",
            "video/x-sgi-movie" => "mv",
            "audio/make" => "my",
            "application/x-vnd.audioexplosion.mzz" => "mzz",
            "image/naplps" => "nap",
            "image/naplps" => "naplps",
            "application/x-netcdf" => "nc",
            "application/vnd.nokia.configuration-message" => "ncm",
            "image/x-niff" => "nif",
            "image/x-niff" => "niff",
            "application/x-mix-transfer" => "nix",
            "application/x-conference" => "nsc",
            "application/x-navidoc" => "nvd",
            "application/octet-stream" => "o",
            "application/oda" => "oda",
            "application/x-omc" => "omc",
            "application/x-omcdatamaker" => "omcd",
            "application/x-omcregerator" => "omcr",
            "text/x-pascal" => "p",
            "application/pkcs10" => "p10",
            "application/x-pkcs10" => "p10",
            "application/pkcs-12" => "p12",
            "application/x-pkcs12" => "p12",
            "application/x-pkcs7-signature" => "p7a",
            "application/pkcs7-mime" => "p7c",
            "application/x-pkcs7-mime" => "p7c",
            "application/pkcs7-mime" => "p7m",
            "application/x-pkcs7-mime" => "p7m",
            "application/x-pkcs7-certreqresp" => "p7r",
            "application/pkcs7-signature" => "p7s",
            "application/pro_eng" => "part",
            "text/pascal" => "pas",
            "image/x-portable-bitmap" => "pbm",
            "application/vnd.hp-pcl" => "pcl",
            "application/x-pcl" => "pcl",
            "image/x-pict" => "pct",
            "image/x-pcx" => "pcx",
            "chemical/x-pdb" => "pdb",
            "application/pdf" => "pdf",
            "audio/make" => "pfunk",
            "audio/make.my.funk" => "pfunk",
            "image/x-portable-graymap" => "pgm",
            "image/x-portable-greymap" => "pgm",
            "image/pict" => "pic",
            "image/pict" => "pict",
            "application/x-newton-compatible-pkg" => "pkg",
            "application/vnd.ms-pki.pko" => "pko",
            "text/plain" => "pl",
            "text/x-script.perl" => "pl",
            "application/x-pixclscript" => "plx",
            "image/x-xpixmap" => "pm",
            "text/x-script.perl-module" => "pm",
            "application/x-pagemaker" => "pm4",
            "application/x-pagemaker" => "pm5",
            "image/png" => "png",
            "application/x-portable-anymap" => "pnm",
            "image/x-portable-anymap" => "pnm",
            "application/mspowerpoint" => "pot",
            "application/vnd.ms-powerpoint" => "pot",
            "model/x-pov" => "pov",
            "application/vnd.ms-powerpoint" => "ppa",
            "image/x-portable-pixmap" => "ppm",
            "application/mspowerpoint" => "pps",
            "application/vnd.ms-powerpoint" => "pps",
            "application/mspowerpoint" => "ppt",
            "application/powerpoint" => "ppt",
            "application/vnd.ms-powerpoint" => "ppt",
            "application/x-mspowerpoint" => "ppt",
            "application/mspowerpoint" => "ppz",
            "application/x-freelance" => "pre",
            "application/pro_eng" => "prt",
            "application/postscript" => "ps",
            "application/octet-stream" => "psd",
            "paleovu/x-pv" => "pvu",
            "application/vnd.ms-powerpoint" => "pwz",
            "text/x-script.phyton" => "py",
            "application/x-bytecode.python" => "pyc",
            "audio/vnd.qcelp" => "qcp",
            "x-world/x-3dmf" => "qd3",
            "x-world/x-3dmf" => "qd3d",
            "image/x-quicktime" => "qif",
            "video/quicktime" => "qt",
            "video/x-qtc" => "qtc",
            "image/x-quicktime" => "qti",
            "image/x-quicktime" => "qtif",
            "audio/x-pn-realaudio" => "ra",
            "audio/x-pn-realaudio-plugin" => "ra",
            "audio/x-realaudio" => "ra",
            "audio/x-pn-realaudio" => "ram",
            "application/x-cmu-raster" => "ras",
            "image/cmu-raster" => "ras",
            "image/x-cmu-raster" => "ras",
            "image/cmu-raster" => "rast",
            "text/x-script.rexx" => "rexx",
            "image/vnd.rn-realflash" => "rf",
            "image/x-rgb" => "rgb",
            "application/vnd.rn-realmedia" => "rm",
            "audio/x-pn-realaudio" => "rm",
            "audio/mid" => "rmi",
            "audio/x-pn-realaudio" => "rmm",
            "audio/x-pn-realaudio" => "rmp",
            "audio/x-pn-realaudio-plugin" => "rmp",
            "application/ringing-tones" => "rng",
            "application/vnd.nokia.ringing-tone" => "rng",
            "application/vnd.rn-realplayer" => "rnx",
            "application/x-troff" => "roff",
            "image/vnd.rn-realpix" => "rp",
            "audio/x-pn-realaudio-plugin" => "rpm",
            "text/richtext" => "rt",
            "text/vnd.rn-realtext" => "rt",
            "application/rtf" => "rtf",
            "application/x-rtf" => "rtf",
            "text/richtext" => "rtf",
            "application/rtf" => "rtx",
            "text/richtext" => "rtx",
            "video/vnd.rn-realvideo" => "rv",
            "text/x-asm" => "s",
            "audio/s3m" => "s3m",
            "application/octet-stream" => "saveme",
            "application/x-tbook" => "sbk",
            "application/x-lotusscreencam" => "scm",
            "text/x-script.guile" => "scm",
            "text/x-script.scheme" => "scm",
            "video/x-scm" => "scm",
            "text/plain" => "sdml",
            "application/sdp" => "sdp",
            "application/x-sdp" => "sdp",
            "application/sounder" => "sdr",
            "application/sea" => "sea",
            "application/x-sea" => "sea",
            "application/set" => "set",
            "text/sgml" => "sgm",
            "text/x-sgml" => "sgm",
            "text/sgml" => "sgml",
            "text/x-sgml" => "sgml",
            "application/x-bsh" => "sh",
            "application/x-sh" => "sh",
            "application/x-shar" => "sh",
            "text/x-script.sh" => "sh",
            "application/x-bsh" => "shar",
            "application/x-shar" => "shar",
            "text/html" => "shtml",
            "text/x-server-parsed-html" => "shtml",
            "audio/x-psid" => "sid",
            "application/x-sit" => "sit",
            "application/x-stuffit" => "sit",
            "application/x-koan" => "skd",
            "application/x-koan" => "skm",
            "application/x-koan" => "skp",
            "application/x-koan" => "skt",
            "application/x-seelogo" => "sl",
            "application/smil" => "smi",
            "application/smil" => "smil",
            "audio/basic" => "snd",
            "audio/x-adpcm" => "snd",
            "application/solids" => "sol",
            "application/x-pkcs7-certificates" => "spc",
            "text/x-speech" => "spc",
            "application/futuresplash" => "spl",
            "application/x-sprite" => "spr",
            "application/x-sprite" => "sprite",
            "application/x-wais-source" => "src",
            "text/x-server-parsed-html" => "ssi",
            "application/streamingmedia" => "ssm",
            "application/vnd.ms-pki.certstore" => "sst",
            "application/step" => "step",
            "application/sla" => "stl",
            "application/vnd.ms-pki.stl" => "stl",
            "application/x-navistyle" => "stl",
            "application/step" => "stp",
            "application/x-sv4cpio" => "sv4cpio",
            "application/x-sv4crc" => "sv4crc",
            "image/svg+xml" => "svg",
            "image/vnd.dwg" => "svf",
            "image/x-dwg" => "svf",
            "application/x-world" => "svr",
            "x-world/x-svr" => "svr",
            "application/x-shockwave-flash" => "swf",
            "application/x-troff" => "t",
            "text/x-speech" => "talk",
            "application/x-tar" => "tar",
            "application/toolbook" => "tbk",
            "application/x-tbook" => "tbk",
            "application/x-tcl" => "tcl",
            "text/x-script.tcl" => "tcl",
            "text/x-script.tcsh" => "tcsh",
            "application/x-tex" => "tex",
            "application/x-texinfo" => "texi",
            "application/x-texinfo" => "texinfo",
            "application/plain" => "text",
            "text/plain" => "text",
            "application/gnutar" => "tgz",
            "application/x-compressed" => "tgz",
            "image/tiff" => "tif",
            "image/x-tiff" => "tif",
            "image/tiff" => "tiff",
            "image/x-tiff" => "tiff",
            "application/x-troff" => "tr",
            "audio/tsp-audio" => "tsi",
            "application/dsptype" => "tsp",
            "audio/tsplayer" => "tsp",
            "text/tab-separated-values" => "tsv",
            "image/florian" => "turbot",
            "text/plain" => "txt",
            "text/x-uil" => "uil",
            "text/uri-list" => "uni",
            "text/uri-list" => "unis",
            "application/i-deas" => "unv",
            "text/uri-list" => "uri",
            "text/uri-list" => "uris",
            "application/x-ustar" => "ustar",
            "multipart/x-ustar" => "ustar",
            "application/octet-stream" => "uu",
            "text/x-uuencode" => "uu",
            "text/x-uuencode" => "uue",
            "application/x-cdlink" => "vcd",
            "text/x-vcalendar" => "vcs",
            "application/vda" => "vda",
            "video/vdo" => "vdo",
            "application/groupwise" => "vew",
            "video/vivo" => "viv",
            "video/vnd.vivo" => "viv",
            "video/vivo" => "vivo",
            "video/vnd.vivo" => "vivo",
            "application/vocaltec-media-desc" => "vmd",
            "application/vocaltec-media-file" => "vmf",
            "audio/voc" => "voc",
            "audio/x-voc" => "voc",
            "video/vosaic" => "vos",
            "audio/voxware" => "vox",
            "audio/x-twinvq-plugin" => "vqe",
            "audio/x-twinvq" => "vqf",
            "audio/x-twinvq-plugin" => "vql",
            "application/x-vrml" => "vrml",
            "model/vrml" => "vrml",
            "x-world/x-vrml" => "vrml",
            "x-world/x-vrt" => "vrt",
            "application/x-visio" => "vsd",
            "application/x-visio" => "vst",
            "application/x-visio" => "vsw",
            "application/wordperfect6.0" => "w60",
            "application/wordperfect6.1" => "w61",
            "application/msword" => "w6w",
            "audio/wav" => "wav",
            "audio/x-wav" => "wav",
            "application/x-qpro" => "wb1",
            "image/vnd.wap.wbmp" => "wbmp",
            "application/vnd.xara" => "web",
            "application/msword" => "wiz",
            "application/x-123" => "wk1",
            "windows/metafile" => "wmf",
            "text/vnd.wap.wml" => "wml",
            "application/vnd.wap.wmlc" => "wmlc",
            "text/vnd.wap.wmlscript" => "wmls",
            "application/vnd.wap.wmlscriptc" => "wmlsc",
            "application/msword" => "word",
            "application/wordperfect" => "wp",
            "application/wordperfect" => "wp5",
            "application/wordperfect6.0" => "wp5",
            "application/wordperfect" => "wp6",
            "application/wordperfect" => "wpd",
            "application/x-wpwin" => "wpd",
            "application/x-lotus" => "wq1",
            "application/mswrite" => "wri",
            "application/x-wri" => "wri",
            "application/x-world" => "wrl",
            "model/vrml" => "wrl",
            "x-world/x-vrml" => "wrl",
            "model/vrml" => "wrz",
            "x-world/x-vrml" => "wrz",
            "text/scriplet" => "wsc",
            "application/x-wais-source" => "wsrc",
            "application/x-wintalk" => "wtk",
            "image/x-xbitmap" => "xbm",
            "image/x-xbm" => "xbm",
            "image/xbm" => "xbm",
            "video/x-amt-demorun" => "xdr",
            "xgl/drawing" => "xgz",
            "image/vnd.xiff" => "xif",
            "application/excel" => "xl",
            "application/excel" => "xla",
            "application/x-excel" => "xla",
            "application/x-msexcel" => "xla",
            "application/excel" => "xlb",
            "application/vnd.ms-excel" => "xlb",
            "application/x-excel" => "xlb",
            "application/excel" => "xlc",
            "application/vnd.ms-excel" => "xlc",
            "application/x-excel" => "xlc",
            "application/excel" => "xld",
            "application/x-excel" => "xld",
            "application/excel" => "xlk",
            "application/x-excel" => "xlk",
            "application/excel" => "xll",
            "application/vnd.ms-excel" => "xll",
            "application/x-excel" => "xll",
            "application/excel" => "xlm",
            "application/vnd.ms-excel" => "xlm",
            "application/x-excel" => "xlm",
            "application/excel" => "xls",
            "application/vnd.ms-excel" => "xls",
            "application/x-excel" => "xls",
            "application/x-msexcel" => "xls",
            "application/excel" => "xlt",
            "application/x-excel" => "xlt",
            "application/excel" => "xlv",
            "application/x-excel" => "xlv",
            "application/excel" => "xlw",
            "application/vnd.ms-excel" => "xlw",
            "application/x-excel" => "xlw",
            "application/x-msexcel" => "xlw",
            "audio/xm" => "xm",
            "application/xml" => "xml",
            "text/xml" => "xml",
            "xgl/movie" => "xmz",
            "application/x-vnd.ls-xpix" => "xpix",
            "image/x-xpixmap" => "xpm",
            "image/xpm" => "xpm",
            "image/png" => "x-png",
            "video/x-amt-showrun" => "xsr",
            "image/x-xwd" => "xwd",
            "image/x-xwindowdump" => "xwd",
            "chemical/x-pdb" => "xyz",
            "application/x-compress" => "z",
            "application/x-compressed" => "z",
            "application/x-compressed" => "zip",
            "application/x-zip-compressed" => "zip",
            "application/zip" => "zip",
            "multipart/x-zip" => "zip",
            "application/octet-stream" => "zoo",
            "text/x-script.zsh" => "zsh",
        ];

        return $types[$mime] ?? '';
    }
}
